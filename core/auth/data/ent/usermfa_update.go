// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"ncobase/core/auth/data/ent/predicate"
	"ncobase/core/auth/data/ent/usermfa"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/dialect/sql/sqljson"
	"entgo.io/ent/schema/field"
)

// UserMFAUpdate is the builder for updating UserMFA entities.
type UserMFAUpdate struct {
	config
	hooks    []Hook
	mutation *UserMFAMutation
}

// Where appends a list predicates to the UserMFAUpdate builder.
func (_u *UserMFAUpdate) Where(ps ...predicate.UserMFA) *UserMFAUpdate {
	_u.mutation.Where(ps...)
	return _u
}

// SetUserID sets the "user_id" field.
func (_u *UserMFAUpdate) SetUserID(v string) *UserMFAUpdate {
	_u.mutation.SetUserID(v)
	return _u
}

// SetNillableUserID sets the "user_id" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableUserID(v *string) *UserMFAUpdate {
	if v != nil {
		_u.SetUserID(*v)
	}
	return _u
}

// ClearUserID clears the value of the "user_id" field.
func (_u *UserMFAUpdate) ClearUserID() *UserMFAUpdate {
	_u.mutation.ClearUserID()
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *UserMFAUpdate) SetUpdatedAt(v int64) *UserMFAUpdate {
	_u.mutation.ResetUpdatedAt()
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// AddUpdatedAt adds value to the "updated_at" field.
func (_u *UserMFAUpdate) AddUpdatedAt(v int64) *UserMFAUpdate {
	_u.mutation.AddUpdatedAt(v)
	return _u
}

// ClearUpdatedAt clears the value of the "updated_at" field.
func (_u *UserMFAUpdate) ClearUpdatedAt() *UserMFAUpdate {
	_u.mutation.ClearUpdatedAt()
	return _u
}

// SetEnabled sets the "enabled" field.
func (_u *UserMFAUpdate) SetEnabled(v bool) *UserMFAUpdate {
	_u.mutation.SetEnabled(v)
	return _u
}

// SetNillableEnabled sets the "enabled" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableEnabled(v *bool) *UserMFAUpdate {
	if v != nil {
		_u.SetEnabled(*v)
	}
	return _u
}

// SetTotpSecret sets the "totp_secret" field.
func (_u *UserMFAUpdate) SetTotpSecret(v string) *UserMFAUpdate {
	_u.mutation.SetTotpSecret(v)
	return _u
}

// SetNillableTotpSecret sets the "totp_secret" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableTotpSecret(v *string) *UserMFAUpdate {
	if v != nil {
		_u.SetTotpSecret(*v)
	}
	return _u
}

// ClearTotpSecret clears the value of the "totp_secret" field.
func (_u *UserMFAUpdate) ClearTotpSecret() *UserMFAUpdate {
	_u.mutation.ClearTotpSecret()
	return _u
}

// SetVerifiedAt sets the "verified_at" field.
func (_u *UserMFAUpdate) SetVerifiedAt(v int64) *UserMFAUpdate {
	_u.mutation.ResetVerifiedAt()
	_u.mutation.SetVerifiedAt(v)
	return _u
}

// SetNillableVerifiedAt sets the "verified_at" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableVerifiedAt(v *int64) *UserMFAUpdate {
	if v != nil {
		_u.SetVerifiedAt(*v)
	}
	return _u
}

// AddVerifiedAt adds value to the "verified_at" field.
func (_u *UserMFAUpdate) AddVerifiedAt(v int64) *UserMFAUpdate {
	_u.mutation.AddVerifiedAt(v)
	return _u
}

// ClearVerifiedAt clears the value of the "verified_at" field.
func (_u *UserMFAUpdate) ClearVerifiedAt() *UserMFAUpdate {
	_u.mutation.ClearVerifiedAt()
	return _u
}

// SetLastUsedAt sets the "last_used_at" field.
func (_u *UserMFAUpdate) SetLastUsedAt(v int64) *UserMFAUpdate {
	_u.mutation.ResetLastUsedAt()
	_u.mutation.SetLastUsedAt(v)
	return _u
}

// SetNillableLastUsedAt sets the "last_used_at" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableLastUsedAt(v *int64) *UserMFAUpdate {
	if v != nil {
		_u.SetLastUsedAt(*v)
	}
	return _u
}

// AddLastUsedAt adds value to the "last_used_at" field.
func (_u *UserMFAUpdate) AddLastUsedAt(v int64) *UserMFAUpdate {
	_u.mutation.AddLastUsedAt(v)
	return _u
}

// ClearLastUsedAt clears the value of the "last_used_at" field.
func (_u *UserMFAUpdate) ClearLastUsedAt() *UserMFAUpdate {
	_u.mutation.ClearLastUsedAt()
	return _u
}

// SetRecoveryCodeHashes sets the "recovery_code_hashes" field.
func (_u *UserMFAUpdate) SetRecoveryCodeHashes(v []string) *UserMFAUpdate {
	_u.mutation.SetRecoveryCodeHashes(v)
	return _u
}

// AppendRecoveryCodeHashes appends value to the "recovery_code_hashes" field.
func (_u *UserMFAUpdate) AppendRecoveryCodeHashes(v []string) *UserMFAUpdate {
	_u.mutation.AppendRecoveryCodeHashes(v)
	return _u
}

// ClearRecoveryCodeHashes clears the value of the "recovery_code_hashes" field.
func (_u *UserMFAUpdate) ClearRecoveryCodeHashes() *UserMFAUpdate {
	_u.mutation.ClearRecoveryCodeHashes()
	return _u
}

// SetRecoveryCodesGeneratedAt sets the "recovery_codes_generated_at" field.
func (_u *UserMFAUpdate) SetRecoveryCodesGeneratedAt(v int64) *UserMFAUpdate {
	_u.mutation.ResetRecoveryCodesGeneratedAt()
	_u.mutation.SetRecoveryCodesGeneratedAt(v)
	return _u
}

// SetNillableRecoveryCodesGeneratedAt sets the "recovery_codes_generated_at" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableRecoveryCodesGeneratedAt(v *int64) *UserMFAUpdate {
	if v != nil {
		_u.SetRecoveryCodesGeneratedAt(*v)
	}
	return _u
}

// AddRecoveryCodesGeneratedAt adds value to the "recovery_codes_generated_at" field.
func (_u *UserMFAUpdate) AddRecoveryCodesGeneratedAt(v int64) *UserMFAUpdate {
	_u.mutation.AddRecoveryCodesGeneratedAt(v)
	return _u
}

// ClearRecoveryCodesGeneratedAt clears the value of the "recovery_codes_generated_at" field.
func (_u *UserMFAUpdate) ClearRecoveryCodesGeneratedAt() *UserMFAUpdate {
	_u.mutation.ClearRecoveryCodesGeneratedAt()
	return _u
}

// SetFailedAttempts sets the "failed_attempts" field.
func (_u *UserMFAUpdate) SetFailedAttempts(v int) *UserMFAUpdate {
	_u.mutation.ResetFailedAttempts()
	_u.mutation.SetFailedAttempts(v)
	return _u
}

// SetNillableFailedAttempts sets the "failed_attempts" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableFailedAttempts(v *int) *UserMFAUpdate {
	if v != nil {
		_u.SetFailedAttempts(*v)
	}
	return _u
}

// AddFailedAttempts adds value to the "failed_attempts" field.
func (_u *UserMFAUpdate) AddFailedAttempts(v int) *UserMFAUpdate {
	_u.mutation.AddFailedAttempts(v)
	return _u
}

// SetLockedUntil sets the "locked_until" field.
func (_u *UserMFAUpdate) SetLockedUntil(v int64) *UserMFAUpdate {
	_u.mutation.ResetLockedUntil()
	_u.mutation.SetLockedUntil(v)
	return _u
}

// SetNillableLockedUntil sets the "locked_until" field if the given value is not nil.
func (_u *UserMFAUpdate) SetNillableLockedUntil(v *int64) *UserMFAUpdate {
	if v != nil {
		_u.SetLockedUntil(*v)
	}
	return _u
}

// AddLockedUntil adds value to the "locked_until" field.
func (_u *UserMFAUpdate) AddLockedUntil(v int64) *UserMFAUpdate {
	_u.mutation.AddLockedUntil(v)
	return _u
}

// ClearLockedUntil clears the value of the "locked_until" field.
func (_u *UserMFAUpdate) ClearLockedUntil() *UserMFAUpdate {
	_u.mutation.ClearLockedUntil()
	return _u
}

// Mutation returns the UserMFAMutation object of the builder.
func (_u *UserMFAUpdate) Mutation() *UserMFAMutation {
	return _u.mutation
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (_u *UserMFAUpdate) Save(ctx context.Context) (int, error) {
	_u.defaults()
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *UserMFAUpdate) SaveX(ctx context.Context) int {
	affected, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (_u *UserMFAUpdate) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *UserMFAUpdate) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *UserMFAUpdate) defaults() {
	if _, ok := _u.mutation.UpdatedAt(); !ok && !_u.mutation.UpdatedAtCleared() {
		v := usermfa.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
}

func (_u *UserMFAUpdate) sqlSave(ctx context.Context) (_node int, err error) {
	_spec := sqlgraph.NewUpdateSpec(usermfa.Table, usermfa.Columns, sqlgraph.NewFieldSpec(usermfa.FieldID, field.TypeString))
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.UserID(); ok {
		_spec.SetField(usermfa.FieldUserID, field.TypeString, value)
	}
	if _u.mutation.UserIDCleared() {
		_spec.ClearField(usermfa.FieldUserID, field.TypeString)
	}
	if _u.mutation.CreatedAtCleared() {
		_spec.ClearField(usermfa.FieldCreatedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(usermfa.FieldUpdatedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedUpdatedAt(); ok {
		_spec.AddField(usermfa.FieldUpdatedAt, field.TypeInt64, value)
	}
	if _u.mutation.UpdatedAtCleared() {
		_spec.ClearField(usermfa.FieldUpdatedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.Enabled(); ok {
		_spec.SetField(usermfa.FieldEnabled, field.TypeBool, value)
	}
	if value, ok := _u.mutation.TotpSecret(); ok {
		_spec.SetField(usermfa.FieldTotpSecret, field.TypeString, value)
	}
	if _u.mutation.TotpSecretCleared() {
		_spec.ClearField(usermfa.FieldTotpSecret, field.TypeString)
	}
	if value, ok := _u.mutation.VerifiedAt(); ok {
		_spec.SetField(usermfa.FieldVerifiedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedVerifiedAt(); ok {
		_spec.AddField(usermfa.FieldVerifiedAt, field.TypeInt64, value)
	}
	if _u.mutation.VerifiedAtCleared() {
		_spec.ClearField(usermfa.FieldVerifiedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.LastUsedAt(); ok {
		_spec.SetField(usermfa.FieldLastUsedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedLastUsedAt(); ok {
		_spec.AddField(usermfa.FieldLastUsedAt, field.TypeInt64, value)
	}
	if _u.mutation.LastUsedAtCleared() {
		_spec.ClearField(usermfa.FieldLastUsedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.RecoveryCodeHashes(); ok {
		_spec.SetField(usermfa.FieldRecoveryCodeHashes, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedRecoveryCodeHashes(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, usermfa.FieldRecoveryCodeHashes, value)
		})
	}
	if _u.mutation.RecoveryCodeHashesCleared() {
		_spec.ClearField(usermfa.FieldRecoveryCodeHashes, field.TypeJSON)
	}
	if value, ok := _u.mutation.RecoveryCodesGeneratedAt(); ok {
		_spec.SetField(usermfa.FieldRecoveryCodesGeneratedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedRecoveryCodesGeneratedAt(); ok {
		_spec.AddField(usermfa.FieldRecoveryCodesGeneratedAt, field.TypeInt64, value)
	}
	if _u.mutation.RecoveryCodesGeneratedAtCleared() {
		_spec.ClearField(usermfa.FieldRecoveryCodesGeneratedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.FailedAttempts(); ok {
		_spec.SetField(usermfa.FieldFailedAttempts, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedFailedAttempts(); ok {
		_spec.AddField(usermfa.FieldFailedAttempts, field.TypeInt, value)
	}
	if value, ok := _u.mutation.LockedUntil(); ok {
		_spec.SetField(usermfa.FieldLockedUntil, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedLockedUntil(); ok {
		_spec.AddField(usermfa.FieldLockedUntil, field.TypeInt64, value)
	}
	if _u.mutation.LockedUntilCleared() {
		_spec.ClearField(usermfa.FieldLockedUntil, field.TypeInt64)
	}
	if _node, err = sqlgraph.UpdateNodes(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{usermfa.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	_u.mutation.done = true
	return _node, nil
}

// UserMFAUpdateOne is the builder for updating a single UserMFA entity.
type UserMFAUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *UserMFAMutation
}

// SetUserID sets the "user_id" field.
func (_u *UserMFAUpdateOne) SetUserID(v string) *UserMFAUpdateOne {
	_u.mutation.SetUserID(v)
	return _u
}

// SetNillableUserID sets the "user_id" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableUserID(v *string) *UserMFAUpdateOne {
	if v != nil {
		_u.SetUserID(*v)
	}
	return _u
}

// ClearUserID clears the value of the "user_id" field.
func (_u *UserMFAUpdateOne) ClearUserID() *UserMFAUpdateOne {
	_u.mutation.ClearUserID()
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *UserMFAUpdateOne) SetUpdatedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.ResetUpdatedAt()
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// AddUpdatedAt adds value to the "updated_at" field.
func (_u *UserMFAUpdateOne) AddUpdatedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.AddUpdatedAt(v)
	return _u
}

// ClearUpdatedAt clears the value of the "updated_at" field.
func (_u *UserMFAUpdateOne) ClearUpdatedAt() *UserMFAUpdateOne {
	_u.mutation.ClearUpdatedAt()
	return _u
}

// SetEnabled sets the "enabled" field.
func (_u *UserMFAUpdateOne) SetEnabled(v bool) *UserMFAUpdateOne {
	_u.mutation.SetEnabled(v)
	return _u
}

// SetNillableEnabled sets the "enabled" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableEnabled(v *bool) *UserMFAUpdateOne {
	if v != nil {
		_u.SetEnabled(*v)
	}
	return _u
}

// SetTotpSecret sets the "totp_secret" field.
func (_u *UserMFAUpdateOne) SetTotpSecret(v string) *UserMFAUpdateOne {
	_u.mutation.SetTotpSecret(v)
	return _u
}

// SetNillableTotpSecret sets the "totp_secret" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableTotpSecret(v *string) *UserMFAUpdateOne {
	if v != nil {
		_u.SetTotpSecret(*v)
	}
	return _u
}

// ClearTotpSecret clears the value of the "totp_secret" field.
func (_u *UserMFAUpdateOne) ClearTotpSecret() *UserMFAUpdateOne {
	_u.mutation.ClearTotpSecret()
	return _u
}

// SetVerifiedAt sets the "verified_at" field.
func (_u *UserMFAUpdateOne) SetVerifiedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.ResetVerifiedAt()
	_u.mutation.SetVerifiedAt(v)
	return _u
}

// SetNillableVerifiedAt sets the "verified_at" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableVerifiedAt(v *int64) *UserMFAUpdateOne {
	if v != nil {
		_u.SetVerifiedAt(*v)
	}
	return _u
}

// AddVerifiedAt adds value to the "verified_at" field.
func (_u *UserMFAUpdateOne) AddVerifiedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.AddVerifiedAt(v)
	return _u
}

// ClearVerifiedAt clears the value of the "verified_at" field.
func (_u *UserMFAUpdateOne) ClearVerifiedAt() *UserMFAUpdateOne {
	_u.mutation.ClearVerifiedAt()
	return _u
}

// SetLastUsedAt sets the "last_used_at" field.
func (_u *UserMFAUpdateOne) SetLastUsedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.ResetLastUsedAt()
	_u.mutation.SetLastUsedAt(v)
	return _u
}

// SetNillableLastUsedAt sets the "last_used_at" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableLastUsedAt(v *int64) *UserMFAUpdateOne {
	if v != nil {
		_u.SetLastUsedAt(*v)
	}
	return _u
}

// AddLastUsedAt adds value to the "last_used_at" field.
func (_u *UserMFAUpdateOne) AddLastUsedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.AddLastUsedAt(v)
	return _u
}

// ClearLastUsedAt clears the value of the "last_used_at" field.
func (_u *UserMFAUpdateOne) ClearLastUsedAt() *UserMFAUpdateOne {
	_u.mutation.ClearLastUsedAt()
	return _u
}

// SetRecoveryCodeHashes sets the "recovery_code_hashes" field.
func (_u *UserMFAUpdateOne) SetRecoveryCodeHashes(v []string) *UserMFAUpdateOne {
	_u.mutation.SetRecoveryCodeHashes(v)
	return _u
}

// AppendRecoveryCodeHashes appends value to the "recovery_code_hashes" field.
func (_u *UserMFAUpdateOne) AppendRecoveryCodeHashes(v []string) *UserMFAUpdateOne {
	_u.mutation.AppendRecoveryCodeHashes(v)
	return _u
}

// ClearRecoveryCodeHashes clears the value of the "recovery_code_hashes" field.
func (_u *UserMFAUpdateOne) ClearRecoveryCodeHashes() *UserMFAUpdateOne {
	_u.mutation.ClearRecoveryCodeHashes()
	return _u
}

// SetRecoveryCodesGeneratedAt sets the "recovery_codes_generated_at" field.
func (_u *UserMFAUpdateOne) SetRecoveryCodesGeneratedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.ResetRecoveryCodesGeneratedAt()
	_u.mutation.SetRecoveryCodesGeneratedAt(v)
	return _u
}

// SetNillableRecoveryCodesGeneratedAt sets the "recovery_codes_generated_at" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableRecoveryCodesGeneratedAt(v *int64) *UserMFAUpdateOne {
	if v != nil {
		_u.SetRecoveryCodesGeneratedAt(*v)
	}
	return _u
}

// AddRecoveryCodesGeneratedAt adds value to the "recovery_codes_generated_at" field.
func (_u *UserMFAUpdateOne) AddRecoveryCodesGeneratedAt(v int64) *UserMFAUpdateOne {
	_u.mutation.AddRecoveryCodesGeneratedAt(v)
	return _u
}

// ClearRecoveryCodesGeneratedAt clears the value of the "recovery_codes_generated_at" field.
func (_u *UserMFAUpdateOne) ClearRecoveryCodesGeneratedAt() *UserMFAUpdateOne {
	_u.mutation.ClearRecoveryCodesGeneratedAt()
	return _u
}

// SetFailedAttempts sets the "failed_attempts" field.
func (_u *UserMFAUpdateOne) SetFailedAttempts(v int) *UserMFAUpdateOne {
	_u.mutation.ResetFailedAttempts()
	_u.mutation.SetFailedAttempts(v)
	return _u
}

// SetNillableFailedAttempts sets the "failed_attempts" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableFailedAttempts(v *int) *UserMFAUpdateOne {
	if v != nil {
		_u.SetFailedAttempts(*v)
	}
	return _u
}

// AddFailedAttempts adds value to the "failed_attempts" field.
func (_u *UserMFAUpdateOne) AddFailedAttempts(v int) *UserMFAUpdateOne {
	_u.mutation.AddFailedAttempts(v)
	return _u
}

// SetLockedUntil sets the "locked_until" field.
func (_u *UserMFAUpdateOne) SetLockedUntil(v int64) *UserMFAUpdateOne {
	_u.mutation.ResetLockedUntil()
	_u.mutation.SetLockedUntil(v)
	return _u
}

// SetNillableLockedUntil sets the "locked_until" field if the given value is not nil.
func (_u *UserMFAUpdateOne) SetNillableLockedUntil(v *int64) *UserMFAUpdateOne {
	if v != nil {
		_u.SetLockedUntil(*v)
	}
	return _u
}

// AddLockedUntil adds value to the "locked_until" field.
func (_u *UserMFAUpdateOne) AddLockedUntil(v int64) *UserMFAUpdateOne {
	_u.mutation.AddLockedUntil(v)
	return _u
}

// ClearLockedUntil clears the value of the "locked_until" field.
func (_u *UserMFAUpdateOne) ClearLockedUntil() *UserMFAUpdateOne {
	_u.mutation.ClearLockedUntil()
	return _u
}

// Mutation returns the UserMFAMutation object of the builder.
func (_u *UserMFAUpdateOne) Mutation() *UserMFAMutation {
	return _u.mutation
}

// Where appends a list predicates to the UserMFAUpdate builder.
func (_u *UserMFAUpdateOne) Where(ps ...predicate.UserMFA) *UserMFAUpdateOne {
	_u.mutation.Where(ps...)
	return _u
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (_u *UserMFAUpdateOne) Select(field string, fields ...string) *UserMFAUpdateOne {
	_u.fields = append([]string{field}, fields...)
	return _u
}

// Save executes the query and returns the updated UserMFA entity.
func (_u *UserMFAUpdateOne) Save(ctx context.Context) (*UserMFA, error) {
	_u.defaults()
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *UserMFAUpdateOne) SaveX(ctx context.Context) *UserMFA {
	node, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (_u *UserMFAUpdateOne) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *UserMFAUpdateOne) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *UserMFAUpdateOne) defaults() {
	if _, ok := _u.mutation.UpdatedAt(); !ok && !_u.mutation.UpdatedAtCleared() {
		v := usermfa.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
}

func (_u *UserMFAUpdateOne) sqlSave(ctx context.Context) (_node *UserMFA, err error) {
	_spec := sqlgraph.NewUpdateSpec(usermfa.Table, usermfa.Columns, sqlgraph.NewFieldSpec(usermfa.FieldID, field.TypeString))
	id, ok := _u.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "UserMFA.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := _u.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, usermfa.FieldID)
		for _, f := range fields {
			if !usermfa.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != usermfa.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.UserID(); ok {
		_spec.SetField(usermfa.FieldUserID, field.TypeString, value)
	}
	if _u.mutation.UserIDCleared() {
		_spec.ClearField(usermfa.FieldUserID, field.TypeString)
	}
	if _u.mutation.CreatedAtCleared() {
		_spec.ClearField(usermfa.FieldCreatedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(usermfa.FieldUpdatedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedUpdatedAt(); ok {
		_spec.AddField(usermfa.FieldUpdatedAt, field.TypeInt64, value)
	}
	if _u.mutation.UpdatedAtCleared() {
		_spec.ClearField(usermfa.FieldUpdatedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.Enabled(); ok {
		_spec.SetField(usermfa.FieldEnabled, field.TypeBool, value)
	}
	if value, ok := _u.mutation.TotpSecret(); ok {
		_spec.SetField(usermfa.FieldTotpSecret, field.TypeString, value)
	}
	if _u.mutation.TotpSecretCleared() {
		_spec.ClearField(usermfa.FieldTotpSecret, field.TypeString)
	}
	if value, ok := _u.mutation.VerifiedAt(); ok {
		_spec.SetField(usermfa.FieldVerifiedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedVerifiedAt(); ok {
		_spec.AddField(usermfa.FieldVerifiedAt, field.TypeInt64, value)
	}
	if _u.mutation.VerifiedAtCleared() {
		_spec.ClearField(usermfa.FieldVerifiedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.LastUsedAt(); ok {
		_spec.SetField(usermfa.FieldLastUsedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedLastUsedAt(); ok {
		_spec.AddField(usermfa.FieldLastUsedAt, field.TypeInt64, value)
	}
	if _u.mutation.LastUsedAtCleared() {
		_spec.ClearField(usermfa.FieldLastUsedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.RecoveryCodeHashes(); ok {
		_spec.SetField(usermfa.FieldRecoveryCodeHashes, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedRecoveryCodeHashes(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, usermfa.FieldRecoveryCodeHashes, value)
		})
	}
	if _u.mutation.RecoveryCodeHashesCleared() {
		_spec.ClearField(usermfa.FieldRecoveryCodeHashes, field.TypeJSON)
	}
	if value, ok := _u.mutation.RecoveryCodesGeneratedAt(); ok {
		_spec.SetField(usermfa.FieldRecoveryCodesGeneratedAt, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedRecoveryCodesGeneratedAt(); ok {
		_spec.AddField(usermfa.FieldRecoveryCodesGeneratedAt, field.TypeInt64, value)
	}
	if _u.mutation.RecoveryCodesGeneratedAtCleared() {
		_spec.ClearField(usermfa.FieldRecoveryCodesGeneratedAt, field.TypeInt64)
	}
	if value, ok := _u.mutation.FailedAttempts(); ok {
		_spec.SetField(usermfa.FieldFailedAttempts, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedFailedAttempts(); ok {
		_spec.AddField(usermfa.FieldFailedAttempts, field.TypeInt, value)
	}
	if value, ok := _u.mutation.LockedUntil(); ok {
		_spec.SetField(usermfa.FieldLockedUntil, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedLockedUntil(); ok {
		_spec.AddField(usermfa.FieldLockedUntil, field.TypeInt64, value)
	}
	if _u.mutation.LockedUntilCleared() {
		_spec.ClearField(usermfa.FieldLockedUntil, field.TypeInt64)
	}
	_node = &UserMFA{config: _u.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{usermfa.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	_u.mutation.done = true
	return _node, nil
}
